#!/usr/bin/env python

import sys
import subprocess
from pathlib import Path

def main():
  if len(sys.argv) == 1:
    print("usage: anywslpath PATH")
    return
  
  path = Path(sys.argv[1]).resolve()
  if path.parts[0] != '/':
    return 1
  if path.parts[1] == 'mnt' and len(path.parts[2]) == 1:
    print(path.parts[2].upper() + ':\\' + '\\'.join(path.parts[3:]))
  else:
    try:
      resp = subprocess.check_output(['wslpath', '-w', '/'])
      path_prefix = resp.decode('utf-8').replace('\n', '')
      print(path_prefix + '\\'.join(path.parts[1:]))
    except:
      print('Error: wslpath not found.')
      return 1
  return 0

if __name__ == "__main__":
  main()
