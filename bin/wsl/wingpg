#!/bin/bash

modify_args() {
  local wslpath="anywslpath"
  local file_options=("-o" "--output" "--options" "--log-file")
  local arg_options=("--tofu-policy" "--default-key" "--encrypt-to" "--group" "--auto-key-locate" "-r" "--recipient" "-u" "--local-user")

  local argc=$#
  local argv=("$@")

  for (( i=0; i<argc; i++ )); do
    for opt in "${file_options[@]}"; do
      if [[ "${argv[$i]}" == "$opt" ]]; then
        i=$((i+1))
        argv[$i]="$($wslpath "${argv[$i]}")"
        continue
      fi
    done
    if [[ "${argv[$i]:0:1}" == "-" ]]; then
      for opt in "${arg_options[@]}"; do
        if [[ "${argv[$i]}" == "$opt" ]]; then
          i=$((i+1))
          continue
        fi
      done
      continue
    fi
    argv[$i]="$($wslpath "${argv[$i]}")"
  done

  echo "${argv[@]}"
}

gpg.exe $(modify_args "$@")
